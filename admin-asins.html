<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Platform ASIN Management - SellersMedia Admin</title>
    
    <!-- Demo Configuration (Replace with config.js for production) -->
    <script src="demo-config.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
        }
        
        .header {
            background: #2c3e50;
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            font-size: 1.8rem;
            font-weight: 300;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .admin-indicator {
            background: #e74c3c;
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .back-btn {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .back-btn:hover {
            background: rgba(255,255,255,0.2);
            color: white;
        }
        
        .logout-btn {
            background: transparent;
            border: 2px solid white;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .logout-btn:hover {
            background: white;
            color: #2c3e50;
        }
        
        .container {
            max-width: 1400px;
            margin: 2rem auto;
            padding: 0 1rem;
        }
        
        .page-header {
            background: white;
            padding: 2rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 2rem;
        }
        
        .admin-controls {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 1rem 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .admin-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .admin-btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .btn-upload {
            background: #28a745;
            color: white;
        }
        
        .btn-download {
            background: #17a2b8;
            color: white;
        }
        
        .btn-template {
            background: #6c757d;
            color: white;
        }
        
        .admin-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        
        .asin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }
        
        .stat-card {
            background: white;
            padding: 1.5rem;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.2s;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        .stat-card.total {
            border-left: 4px solid #667eea;
        }
        
        .stat-card.active {
            border-left: 4px solid #28a745;
        }
        
        
        .stat-card.commission {
            border-left: 4px solid #e74c3c;
        }
        
        .stat-card.sellers {
            border-left: 4px solid #6f42c1;
        }
        
        .stat-number {
            font-size: 2.2rem;
            font-weight: bold;
            color: #2c3e50;
            display: block;
            margin-bottom: 0.5rem;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .table-section {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .table-header {
            background: #f8f9fa;
            padding: 1.5rem;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .search-controls {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }
        
        .search-input {
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.9rem;
            min-width: 250px;
        }
        
        .filter-select {
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.9rem;
        }
        
        .table-container {
            overflow-x: auto;
        }
        
        .asins-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            table-layout: fixed;
            min-width: 1300px;
        }
        
        .asins-table th {
            background: #f8f9fa;
            padding: 1rem;
            text-align: left;
            font-weight: 600;
            color: #495057;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border-bottom: 2px solid #dee2e6;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        
        .asins-table td {
            padding: 1rem;
            border-bottom: 1px solid #f1f3f4;
            vertical-align: middle;
        }
        
        .asins-table tr:hover {
            background: #f8f9fa;
        }
        
        /* Column widths */
        .col-seller { width: 130px; }
        .col-asin { width: 120px; }
        .col-product { width: 280px; }
        .col-brand { width: 130px; }
        .col-country { width: 90px; }
        .col-price { width: 110px; }
        .col-commission { width: 110px; }
        .col-actions { width: 130px; }
        
        .seller-info {
            display: flex;
            flex-direction: column;
            gap: 0.2rem;
        }
        
        .seller-name {
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.9rem;
        }
        
        .seller-id {
            font-size: 0.8rem;
            color: #666;
            font-family: monospace;
        }
        
        .asin-code {
            font-family: monospace;
            font-weight: 600;
            color: #667eea;
            font-size: 0.9rem;
        }
        
        .product-info {
            display: flex;
            flex-direction: column;
            gap: 0.2rem;
        }
        
        .product-name {
            font-weight: 500;
            color: #2c3e50;
            font-size: 0.9rem;
            line-height: 1.3;
        }
        
        .product-category {
            font-size: 0.8rem;
            color: #666;
        }
        
        .brand-name {
            font-weight: 500;
            color: #2c3e50;
        }
        
        .country-flag {
            font-size: 1.1rem;
        }
        
        .price-info {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
        }
        
        .price-amount {
            font-weight: 600;
            color: #2c3e50;
        }
        
        .currency-code {
            font-size: 0.8rem;
            color: #666;
        }
        
        .commission-rate {
            font-weight: 600;
            color: #28a745;
        }
        
        
        .action-buttons {
            display: flex;
            gap: 0.3rem;
            justify-content: center;
        }
        
        .action-btn {
            padding: 0.3rem 0.6rem;
            border: none;
            border-radius: 3px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-edit {
            background: #667eea;
            color: white;
        }
        
        .btn-delete {
            background: #dc3545;
            color: white;
        }
        
        .btn-edit:hover { background: #5a6fd8; }
        .btn-delete:hover { background: #c82333; }
        
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 0.5rem;
            padding: 2rem;
            background: #f8f9fa;
            border-top: 1px solid #dee2e6;
        }
        
        .pagination-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #ddd;
            background: white;
            color: #666;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .pagination-btn:hover:not(:disabled) {
            background: #f8f9fa;
            border-color: #667eea;
            color: #667eea;
        }
        
        .pagination-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }
        
        .pagination-btn:disabled {
            background: #f8f9fa;
            color: #ccc;
            border-color: #eee;
            cursor: not-allowed;
        }
        
        .pagination-info {
            margin: 0 1rem;
            color: #666;
            font-size: 0.9rem;
        }
        
        /* File upload modal styles */
        .upload-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .upload-modal.show {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 8px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #dee2e6;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-body {
            padding: 1.5rem;
        }
        
        .modal-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid #dee2e6;
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #666;
        }
        
        .upload-area {
            border: 2px dashed #ddd;
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
            margin-bottom: 1.5rem;
        }
        
        .upload-area:hover, .upload-area.dragover {
            border-color: #667eea;
            background: #f8f9ff;
        }
        
        .upload-icon {
            font-size: 3rem;
            color: #ccc;
            margin-bottom: 1rem;
        }
        
        .file-input {
            display: none;
        }
        
        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .btn-primary {
            background: #667eea;
            color: white;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        
        .upload-options {
            margin-bottom: 1.5rem;
        }
        
        .upload-option {
            display: flex;
            align-items: flex-start;
            gap: 0.5rem;
            padding: 1rem;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-bottom: 0.5rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .upload-option:hover {
            background: #f8f9fa;
            border-color: #667eea;
        }
        
        .upload-option.selected {
            background: #f0f8ff;
            border-color: #667eea;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 0 0.5rem;
            }
            
            .asin-stats {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
            
            .admin-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .search-input {
                min-width: auto;
            }
        }
        
        @media (max-width: 480px) {
            .asin-stats {
                grid-template-columns: 1fr;
            }
            
            .admin-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <div>
            <h1>
                Platform ASIN Management
                <span class="admin-indicator">Admin View</span>
            </h1>
        </div>
        <div class="user-info">
            <a href="admin-dashboard.html" class="back-btn">
                ‚Üê Back to Dashboard
            </a>
            <span style="color: white;">admin@sellersmedia.com</span>
            <button class="logout-btn" onclick="window.location.href='index.html'">Logout</button>
        </div>
    </div>
    
    <div class="container">
        <div class="page-header">
            <h2 style="color: #2c3e50; margin-bottom: 0.5rem;">All Platform ASINs</h2>
            <p style="color: #666;">Comprehensive view and management of all ASINs across all sellers on the platform.</p>
        </div>
        
        <div class="admin-controls">
            <div>
                <strong>Platform Management:</strong> View, edit, and manage ASINs from all sellers with administrative privileges.
            </div>
            <div class="admin-actions">
                <button class="admin-btn btn-upload" onclick="showUploadModal()">
                    üì§ Upload ASINs
                </button>
                <button class="admin-btn btn-download" onclick="downloadAllASINs()">
                    üì• Download All
                </button>
                <button class="admin-btn btn-template" onclick="downloadTemplate()">
                    üìã CSV Template
                </button>
            </div>
        </div>
        
        <div class="asin-stats">
            <div class="stat-card total">
                <span class="stat-number" id="totalAsins">27</span>
                <div class="stat-label">Total ASINs</div>
            </div>
            <div class="stat-card commission">
                <span class="stat-number" id="avgCommission">15.4%</span>
                <div class="stat-label">Avg Commission</div>
            </div>
            <div class="stat-card sellers">
                <span class="stat-number" id="activeSellers">8</span>
                <div class="stat-label">Active Sellers</div>
            </div>
            <div class="stat-card active">
                <span class="stat-number" id="totalCategories">9</span>
                <div class="stat-label">Categories</div>
            </div>
        </div>
        
        <div class="table-section">
            <div class="table-header">
                <h3 style="color: #2c3e50; margin: 0;">Platform ASIN Database</h3>
                <div class="search-controls">
                    <input type="text" class="search-input" placeholder="Search ASINs, products, sellers..." id="searchInput">
                    <select class="filter-select" id="sellerFilter">
                        <option value="">All Sellers</option>
                    </select>
                </div>
            </div>
            
            <div class="table-container">
                <table class="asins-table">
                    <thead>
                        <tr>
                            <th class="col-seller">Seller</th>
                            <th class="col-asin">ASIN</th>
                            <th class="col-product">Product</th>
                            <th class="col-brand">Brand</th>
                            <th class="col-country">Country</th>
                            <th class="col-price">Price</th>
                            <th class="col-commission">Commission</th>
                            <th class="col-actions">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="asinsTable">
                        <!-- ASINs will be loaded here -->
                    </tbody>
                </table>
            </div>
            
            <div class="pagination" id="paginationControls">
                <!-- Pagination will be rendered here -->
            </div>
        </div>
    </div>
    
    <!-- Upload Modal -->
    <div class="upload-modal" id="uploadModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Upload ASIN CSV File</h3>
                <button class="close-btn" onclick="closeUploadModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="uploadStep1" class="upload-step">
                    <div class="upload-area" onclick="document.getElementById('csvFileInput').click()">
                        <div class="upload-icon">üìÅ</div>
                        <h4>Select CSV File</h4>
                        <p>Click here or drag & drop your CSV file</p>
                        <small style="color: #666;">Supported format: .csv (max 10MB)</small>
                    </div>
                    <input type="file" id="csvFileInput" class="file-input" accept=".csv" onchange="handleFileSelect(this)">
                    
                    <div style="margin-top: 1rem;">
                        <h5>Required CSV Format:</h5>
                        <div style="background: #f8f9fa; padding: 1rem; border-radius: 4px; margin-top: 0.5rem; font-family: monospace; font-size: 0.8rem; overflow-x: auto;">
seller_id,brand,product_name,country,ASIN,product_price,currency,% Commission,UPC_EAN_GTIN,expiry_date,category,comment,custom_label1
                        </div>
                    </div>
                </div>
                
                <div id="uploadStep2" class="upload-step" style="display: none;">
                    <div style="background: #e8f5e8; padding: 1rem; border-radius: 6px; margin-bottom: 1.5rem;">
                        <div style="display: flex; align-items: center; gap: 0.5rem; margin-bottom: 0.5rem;">
                            <span style="color: #28a745;">‚úì</span>
                            <strong>File Selected:</strong> <span id="selectedFileName"></span>
                        </div>
                        <div style="font-size: 0.9rem; color: #666;">
                            Size: <span id="selectedFileSize"></span>
                        </div>
                    </div>
                    
                    <div class="upload-options">
                        <h4 style="margin-bottom: 1rem; color: #2c3e50;">Upload Options:</h4>
                        
                        <div class="upload-option selected" onclick="selectUploadOption('replace', this)">
                            <input type="radio" name="uploadMode" value="replace" checked>
                            <div>
                                <strong>Replace All ASINs</strong>
                                <div style="font-size: 0.8rem; color: #666; margin-top: 0.2rem;">
                                    Remove all existing ASINs and upload new ones from the CSV
                                </div>
                            </div>
                        </div>
                        
                        <div class="upload-option" onclick="selectUploadOption('add', this)">
                            <input type="radio" name="uploadMode" value="add">
                            <div>
                                <strong>Add New ASINs</strong>
                                <div style="font-size: 0.8rem; color: #666; margin-top: 0.2rem;">
                                    Keep existing ASINs and add new ones (skip duplicates)
                                </div>
                            </div>
                        </div>
                        
                        <div class="upload-option" onclick="selectUploadOption('update', this)">
                            <input type="radio" name="uploadMode" value="update">
                            <div>
                                <strong>Update Existing ASINs</strong>
                                <div style="font-size: 0.8rem; color: #666; margin-top: 0.2rem;">
                                    Update existing ASINs with new data, add non-existing ones
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeUploadModal()">Cancel</button>
                <button class="btn btn-primary" id="uploadBtn" onclick="processUpload()" style="display: none;">
                    Upload ASINs
                </button>
            </div>
        </div>
    </div>

    <script>
        // Demo ASIN data with 27 entries across multiple sellers
        const demoAsins = [
            { sellerId: 'S001', sellerName: 'Sarah Johnson', ASIN: 'B08N5WRWNW', product_name: 'Wireless Bluetooth Headphones Pro', brand: 'AudioMax', country: 'US', currency: 'USD', product_price: 79.99, commission: 15, status: 'active', category: 'Electronics' },
            { sellerId: 'S001', sellerName: 'Sarah Johnson', ASIN: 'B07XJ8C8F5', product_name: 'Smart Fitness Tracker Watch', brand: 'FitTrack', country: 'US', currency: 'USD', product_price: 129.99, commission: 18, status: 'active', category: 'Wearables' },
            { sellerId: 'S001', sellerName: 'Sarah Johnson', ASIN: 'B09KMVJY8P', product_name: 'Gaming Mechanical RGB Keyboard', brand: 'GameMaster', country: 'US', currency: 'USD', product_price: 159.99, commission: 12, status: 'pending', category: 'Gaming' },
            { sellerId: 'S002', sellerName: 'Michael Chen', ASIN: 'B07VJKQXW9', product_name: 'Wireless Charging Pad Fast', brand: 'ChargeTech', country: 'UK', currency: 'GBP', product_price: 24.99, commission: 20, status: 'active', category: 'Accessories' },
            { sellerId: 'S002', sellerName: 'Michael Chen', ASIN: 'B08XQVYQMH', product_name: 'USB-C Hub 7-in-1', brand: 'ConnectPro', country: 'UK', currency: 'GBP', product_price: 45.99, commission: 16, status: 'active', category: 'Accessories' },
            { sellerId: 'S002', sellerName: 'Michael Chen', ASIN: 'B07PDHSJ41', product_name: 'Laptop Stand Adjustable Aluminum', brand: 'DeskMate', country: 'UK', currency: 'GBP', product_price: 39.99, commission: 14, status: 'active', category: 'Office' },
            { sellerId: 'S003', sellerName: 'Emma Rodriguez', ASIN: 'B08K9JDMN2', product_name: 'Essential Oil Diffuser LED', brand: 'AromaHome', country: 'CA', currency: 'CAD', product_price: 89.99, commission: 22, status: 'active', category: 'Home & Garden' },
            { sellerId: 'S003', sellerName: 'Emma Rodriguez', ASIN: 'B09L7QSTPX', product_name: 'Kitchen Scale Digital Precision', brand: 'CookPro', country: 'CA', currency: 'CAD', product_price: 34.99, commission: 18, status: 'active', category: 'Kitchen' },
            { sellerId: 'S003', sellerName: 'Emma Rodriguez', ASIN: 'B08FGHIJK3', product_name: 'Yoga Mat Premium Non-Slip', brand: 'FitZen', country: 'CA', currency: 'CAD', product_price: 49.99, commission: 15, status: 'pending', category: 'Sports & Outdoors' },
            { sellerId: 'S004', sellerName: 'Hans Mueller', ASIN: 'B07MNBVCXZ', product_name: 'Power Drill Cordless 20V', brand: 'ProTools', country: 'DE', currency: 'EUR', product_price: 149.99, commission: 10, status: 'active', category: 'Tools' },
            { sellerId: 'S004', sellerName: 'Hans Mueller', ASIN: 'B08QWERTY1', product_name: 'Tool Set Professional 150pc', brand: 'MasterCraft', country: 'DE', currency: 'EUR', product_price: 199.99, commission: 12, status: 'active', category: 'Tools' },
            { sellerId: 'S004', sellerName: 'Hans Mueller', ASIN: 'B09ASDFGH2', product_name: 'Work Light LED Rechargeable', brand: 'BrightWork', country: 'DE', currency: 'EUR', product_price: 59.99, commission: 16, status: 'active', category: 'Tools' },
            { sellerId: 'S005', sellerName: 'Marie Dubois', ASIN: 'B08ZXCVBN4', product_name: 'Luxury Silk Scarf Designer', brand: 'EleganceParis', country: 'FR', currency: 'EUR', product_price: 89.99, commission: 25, status: 'active', category: 'Fashion' },
            { sellerId: 'S005', sellerName: 'Marie Dubois', ASIN: 'B09POIUYT5', product_name: 'French Press Coffee Maker', brand: 'Caf√©Royal', country: 'FR', currency: 'EUR', product_price: 64.99, commission: 20, status: 'active', category: 'Kitchen' },
            { sellerId: 'S006', sellerName: 'James Wilson', ASIN: 'B08HJKLMN6', product_name: 'Camping Tent 4-Person Waterproof', brand: 'OutdoorPro', country: 'US', currency: 'USD', product_price: 179.99, commission: 14, status: 'active', category: 'Sports & Outdoors' },
            { sellerId: 'S006', sellerName: 'James Wilson', ASIN: 'B09TYUIOP7', product_name: 'Hiking Backpack 50L', brand: 'TrailMaster', country: 'US', currency: 'USD', product_price: 119.99, commission: 16, status: 'active', category: 'Sports & Outdoors' },
            { sellerId: 'S006', sellerName: 'James Wilson', ASIN: 'B08DFGHJK8', product_name: 'Portable Water Filter Bottle', brand: 'PureTrek', country: 'US', currency: 'USD', product_price: 39.99, commission: 18, status: 'active', category: 'Sports & Outdoors' },
            { sellerId: 'S007', sellerName: 'Anna Kowalski', ASIN: 'B09WERTYU9', product_name: 'Memory Foam Pillow Contour', brand: 'ComfortSleep', country: 'PL', currency: 'EUR', product_price: 49.99, commission: 19, status: 'active', category: 'Home & Garden' },
            { sellerId: 'S007', sellerName: 'Anna Kowalski', ASIN: 'B08SDFGHJ0', product_name: 'Air Purifier HEPA Filter', brand: 'CleanAir', country: 'PL', currency: 'EUR', product_price: 159.99, commission: 15, status: 'active', category: 'Home & Garden' },
            { sellerId: 'S008', sellerName: 'Roberto Silva', ASIN: 'B09XCVBNM1', product_name: 'Smartphone Gimbal Stabilizer', brand: 'FilmPro', country: 'BR', currency: 'USD', product_price: 199.99, commission: 17, status: 'active', category: 'Electronics' },
            { sellerId: 'S008', sellerName: 'Roberto Silva', ASIN: 'B08QAZWSX2', product_name: 'Bluetooth Speaker Waterproof', brand: 'SoundWave', country: 'BR', currency: 'USD', product_price: 89.99, commission: 20, status: 'pending', category: 'Electronics' },
            { sellerId: 'S009', sellerName: 'Yuki Tanaka', ASIN: 'B09EDCRFV3', product_name: 'Rice Cooker Smart 10-Cup', brand: 'KitchenJapan', country: 'JP', currency: 'JPY', product_price: 12999, commission: 13, status: 'active', category: 'Kitchen' },
            { sellerId: 'S009', sellerName: 'Yuki Tanaka', ASIN: 'B08TGBYHN4', product_name: 'Green Tea Set Ceramic', brand: 'TeaWay', country: 'JP', currency: 'JPY', product_price: 8999, commission: 16, status: 'active', category: 'Kitchen' },
            { sellerId: 'S010', sellerName: 'Sofia Andersson', ASIN: 'B09RFVTGB5', product_name: 'Wooden Cutting Board Set', brand: 'Nordic Kitchen', country: 'SE', currency: 'EUR', product_price: 69.99, commission: 18, status: 'active', category: 'Kitchen' },
            { sellerId: 'S010', sellerName: 'Sofia Andersson', ASIN: 'B08YHNUJM6', product_name: 'Candle Set Aromatherapy', brand: 'ScandiScent', country: 'SE', currency: 'EUR', product_price: 54.99, commission: 21, status: 'active', category: 'Home & Garden' },
            { sellerId: 'S011', sellerName: 'David Kumar', ASIN: 'B09IKOJUHY7', product_name: 'Spice Rack Rotating Bamboo', brand: 'SpiceWorks', country: 'IN', currency: 'USD', product_price: 29.99, commission: 24, status: 'active', category: 'Kitchen' },
            { sellerId: 'S012', sellerName: 'Lisa Thompson', ASIN: 'B08PLMNBGF8', product_name: 'Beach Umbrella UV Protection', brand: 'SunShade', country: 'AU', currency: 'USD', product_price: 79.99, commission: 17, status: 'active', category: 'Sports & Outdoors' }
        ];

        // Pagination and filtering variables
        let currentPage = 1;
        const itemsPerPage = 20;
        let filteredAsins = [...demoAsins];
        let selectedFile = null;

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            populateSellerFilter();
            updateStats();
            renderAsinsTable();
            setupEventListeners();
        });

        function populateSellerFilter() {
            const sellerFilter = document.getElementById('sellerFilter');
            const uniqueSellers = [...new Set(demoAsins.map(asin => `${asin.sellerId} - ${asin.sellerName}`))];
            
            uniqueSellers.forEach(seller => {
                const option = document.createElement('option');
                option.value = seller.split(' - ')[0];
                option.textContent = seller;
                sellerFilter.appendChild(option);
            });
        }

        function updateStats() {
            const totalAsins = demoAsins.length;
            const avgCommission = (demoAsins.reduce((sum, asin) => sum + asin.commission, 0) / totalAsins).toFixed(1);
            const activeSellers = new Set(demoAsins.map(asin => asin.sellerId)).size;
            const totalCategories = new Set(demoAsins.map(asin => asin.category)).size;

            document.getElementById('totalAsins').textContent = totalAsins;
            document.getElementById('avgCommission').textContent = `${avgCommission}%`;
            document.getElementById('activeSellers').textContent = activeSellers;
            document.getElementById('totalCategories').textContent = totalCategories;
        }

        function setupEventListeners() {
            document.getElementById('searchInput').addEventListener('input', applyFilters);
            document.getElementById('sellerFilter').addEventListener('change', applyFilters);
        }

        function applyFilters() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const sellerFilter = document.getElementById('sellerFilter').value;

            filteredAsins = demoAsins.filter(asin => {
                const matchesSearch = !searchTerm || 
                    asin.ASIN.toLowerCase().includes(searchTerm) ||
                    asin.product_name.toLowerCase().includes(searchTerm) ||
                    asin.sellerName.toLowerCase().includes(searchTerm) ||
                    asin.brand.toLowerCase().includes(searchTerm);
                
                const matchesSeller = !sellerFilter || asin.sellerId === sellerFilter;

                return matchesSearch && matchesSeller;
            });

            currentPage = 1;
            renderAsinsTable();
        }

        function renderAsinsTable() {
            const tbody = document.getElementById('asinsTable');
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const currentAsins = filteredAsins.slice(startIndex, endIndex);

            tbody.innerHTML = currentAsins.map(asin => `
                <tr>
                    <td class="col-seller">
                        <div class="seller-info">
                            <div class="seller-name">${asin.sellerName}</div>
                            <div class="seller-id">${asin.sellerId}</div>
                        </div>
                    </td>
                    <td class="col-asin">
                        <div class="asin-code">${asin.ASIN}</div>
                    </td>
                    <td class="col-product">
                        <div class="product-info">
                            <div class="product-name">${asin.product_name}</div>
                            <div class="product-category">${asin.category}</div>
                        </div>
                    </td>
                    <td class="col-brand">
                        <div class="brand-name">${asin.brand}</div>
                    </td>
                    <td class="col-country">
                        <div class="country-flag">${getCountryFlag(asin.country)}</div>
                    </td>
                    <td class="col-price">
                        <div class="price-info">
                            <div class="price-amount">${formatPrice(asin.product_price, asin.currency)}</div>
                            <div class="currency-code">${asin.currency}</div>
                        </div>
                    </td>
                    <td class="col-commission">
                        <div class="commission-rate">${asin.commission}%</div>
                    </td>
                    <td class="col-actions">
                        <div class="action-buttons">
                            <button class="action-btn btn-edit" onclick="editAsin('${asin.ASIN}')" title="Edit">‚úèÔ∏è</button>
                            <button class="action-btn btn-delete" onclick="deleteAsin('${asin.ASIN}')" title="Delete">üóëÔ∏è</button>
                        </div>
                    </td>
                </tr>
            `).join('');

            renderPagination();
        }

        function renderPagination() {
            const totalPages = Math.ceil(filteredAsins.length / itemsPerPage);
            const paginationContainer = document.getElementById('paginationControls');
            
            if (totalPages <= 1) {
                paginationContainer.innerHTML = `
                    <div class="pagination-info">
                        Showing ${filteredAsins.length} of ${demoAsins.length} ASINs
                    </div>
                `;
                return;
            }

            const startIndex = (currentPage - 1) * itemsPerPage + 1;
            const endIndex = Math.min(currentPage * itemsPerPage, filteredAsins.length);

            let paginationHTML = `
                <button class="pagination-btn" onclick="changePage(1)" ${currentPage === 1 ? 'disabled' : ''}>First</button>
                <button class="pagination-btn" onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>Previous</button>
            `;

            const startPage = Math.max(1, currentPage - 2);
            const endPage = Math.min(totalPages, currentPage + 2);

            for (let i = startPage; i <= endPage; i++) {
                paginationHTML += `
                    <button class="pagination-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>
                `;
            }

            paginationHTML += `
                <button class="pagination-btn" onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>Next</button>
                <button class="pagination-btn" onclick="changePage(${totalPages})" ${currentPage === totalPages ? 'disabled' : ''}>Last</button>
                <div class="pagination-info">
                    Showing ${startIndex}-${endIndex} of ${filteredAsins.length} ASINs (Page ${currentPage} of ${totalPages})
                </div>
            `;

            paginationContainer.innerHTML = paginationHTML;
        }

        function changePage(page) {
            const totalPages = Math.ceil(filteredAsins.length / itemsPerPage);
            if (page >= 1 && page <= totalPages) {
                currentPage = page;
                renderAsinsTable();
            }
        }

        // Utility functions
        function getCountryFlag(country) {
            const flags = {
                'US': 'üá∫üá∏', 'UK': 'üá¨üáß', 'CA': 'üá®üá¶', 'DE': 'üá©üá™', 'FR': 'üá´üá∑',
                'PL': 'üáµüá±', 'BR': 'üáßüá∑', 'JP': 'üáØüáµ', 'SE': 'üá∏üá™', 'IN': 'üáÆüá≥', 'AU': 'üá¶üá∫'
            };
            return flags[country] || 'üåç';
        }

        function formatPrice(price, currency) {
            const symbols = { USD: '$', GBP: '¬£', EUR: '‚Ç¨', CAD: '$', JPY: '¬•' };
            const symbol = symbols[currency] || '$';
            return `${symbol}${price.toLocaleString()}`;
        }

        function capitalizeFirst(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }

        // Download functions
        function downloadAllASINs() {
            const csvContent = generateCSVContent(filteredAsins);
            downloadCSV(csvContent, `platform-asins-${new Date().getFullYear()}-${String(new Date().getMonth() + 1).padStart(2, '0')}-${String(new Date().getDate()).padStart(2, '0')}.csv`);
        }

        function downloadTemplate() {
            const templateContent = `seller_id,brand,product_name,country,ASIN,product_price,currency,% Commission,UPC_EAN_GTIN,expiry_date,category,comment,custom_label1
S001,ExampleBrand,Sample Product Name,US,B08EXAMPLE,29.99,USD,15,123456789012,2024-12-31,Electronics,Sample comment,Premium
S002,TestBrand,Another Product,UK,B07TESTPROD,45.99,GBP,18,,2024-12-31,Home & Garden,,Standard`;
            downloadCSV(templateContent, 'asin-upload-template.csv');
        }

        function generateCSVContent(asins) {
            let csvContent = `SellersMedia Platform ASINs Export - ${new Date().toLocaleDateString()}\n\n`;
            csvContent += `seller_id,seller_name,brand,product_name,country,ASIN,product_price,currency,% Commission,category\n`;
            
            asins.forEach(asin => {
                csvContent += `${asin.sellerId},"${asin.sellerName}","${asin.brand}","${asin.product_name}",${asin.country},${asin.ASIN},${asin.product_price},${asin.currency},${asin.commission},"${asin.category}"\n`;
            });

            return csvContent;
        }

        function downloadCSV(content, filename) {
            const blob = new Blob([content], { type: 'text/csv;charset=utf-8;' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            console.log(`Downloaded: ${filename}`);
        }

        // Upload modal functions
        function showUploadModal() {
            document.getElementById('uploadModal').classList.add('show');
            document.getElementById('uploadStep1').style.display = 'block';
            document.getElementById('uploadStep2').style.display = 'none';
        }

        function closeUploadModal() {
            document.getElementById('uploadModal').classList.remove('show');
            selectedFile = null;
            document.getElementById('csvFileInput').value = '';
            document.getElementById('uploadBtn').style.display = 'none';
        }

        function handleFileSelect(input) {
            const file = input.files[0];
            if (file && file.type === 'text/csv') {
                selectedFile = file;
                document.getElementById('selectedFileName').textContent = file.name;
                document.getElementById('selectedFileSize').textContent = `${(file.size / 1024).toFixed(1)} KB`;
                
                document.getElementById('uploadStep1').style.display = 'none';
                document.getElementById('uploadStep2').style.display = 'block';
                document.getElementById('uploadBtn').style.display = 'inline-block';
            } else {
                alert('Please select a valid CSV file.');
            }
        }

        function selectUploadOption(mode, element) {
            // Remove selected class from all options
            document.querySelectorAll('.upload-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Add selected class to clicked option
            element.classList.add('selected');
            
            // Check the radio button
            element.querySelector('input[type="radio"]').checked = true;
        }

        function processUpload() {
            if (!selectedFile) {
                alert('Please select a file first.');
                return;
            }

            const selectedMode = document.querySelector('input[name="uploadMode"]:checked').value;
            let modeText = '';
            let resultText = '';

            switch(selectedMode) {
                case 'replace':
                    modeText = 'Replace All';
                    resultText = 'All existing ASINs have been removed and 23 new ASINs have been uploaded.';
                    break;
                case 'add':
                    modeText = 'Add New';
                    resultText = '15 new ASINs have been added (8 duplicates were skipped).';
                    break;
                case 'update':
                    modeText = 'Update Existing';
                    resultText = '18 existing ASINs updated, 5 new ASINs added.';
                    break;
            }

            closeUploadModal();

            setTimeout(() => {
                alert(`CSV Upload Complete!\n\nFile: ${selectedFile.name}\nMode: ${modeText}\n\n${resultText}\n\nAll changes have been logged for audit purposes.`);
                
                // Simulate data refresh
                renderAsinsTable();
            }, 300);
        }

        // Action functions
        function editAsin(asinCode) {
            const asin = demoAsins.find(a => a.ASIN === asinCode);
            if (asin) {
                alert(`Edit ASIN: ${asinCode}\nProduct: ${asin.product_name}\nSeller: ${asin.sellerName}\n\nThis would open the ASIN edit modal in a real application.`);
            }
        }

        function deleteAsin(asinCode) {
            if (confirm(`Are you sure you want to delete ASIN ${asinCode}?\n\nThis action cannot be undone.`)) {
                alert(`ASIN ${asinCode} has been deleted.\n\nThis would remove the ASIN from the database in a real application.`);
            }
        }

        // Drag and drop functionality
        document.addEventListener('DOMContentLoaded', function() {
            const uploadArea = document.querySelector('.upload-area');
            
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, preventDefaults, false);
            });

            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }

            ['dragenter', 'dragover'].forEach(eventName => {
                uploadArea.addEventListener(eventName, highlight, false);
            });

            ['dragleave', 'drop'].forEach(eventName => {
                uploadArea.addEventListener(eventName, unhighlight, false);
            });

            function highlight(e) {
                uploadArea.classList.add('dragover');
            }

            function unhighlight(e) {
                uploadArea.classList.remove('dragover');
            }

            uploadArea.addEventListener('drop', handleDrop, false);

            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;

                if (files.length > 0) {
                    const fileInput = document.getElementById('csvFileInput');
                    fileInput.files = files;
                    handleFileSelect(fileInput);
                }
            }
        });

        console.log('Platform ASIN Management loaded with', demoAsins.length, 'demo ASINs');
    </script>
</body>
</html>